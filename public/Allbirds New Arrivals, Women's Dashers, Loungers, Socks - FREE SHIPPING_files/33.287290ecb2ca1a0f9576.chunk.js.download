"use strict";(self.webpackChunkallbirds=self.webpackChunkallbirds||[]).push([[33],{96429:(e,t,r)=>{r(2543),r(5297),r(57107),r(77162),r(16396)},53462:(e,t,r)=>{r.d(t,{hF:()=>s});var i=r(57107);const s=()=>e=>e({type:i.Ay.CLOSE_COLLECTION_PAGE_FILTER_DRAWER})},77162:(e,t,r)=>{r.d(t,{A:()=>_});var i=r(77952),s=r.n(i),a=r(18987),n=r(2543),l=r(57107),o=r(33035),c=r(1311),I=r(362),d=r(40203),u=r(30535),m=r(83619),A=r(74651);const E=class{static get email(){return a.A.get(l.Yb.ALLBIRDS_EMAIL)}static get encryptedEmail(){return a.A.get(l.Yb.ALLBIRDS_ENCRYPTED_EMAIL)}static get userState(){return a.A.get(l.Yb.USER_STATE)}static get dynamicYieldServerID(){return a.A.get(l.Yb.DYNAMIC_YIELD_SERVER)}static get dynamicYieldClientID(){return a.A.get(l.Yb.DYNAMIC_YIELD)}static get allbirdsId(){return a.A.get(l.Yb.ALLBIRDS_ID)}static get userId(){return a.A.get(l.Yb.USER_ID)}static get iterableCampaignId(){return a.A.get(l.Yb.ITERABLE_CAMPAIGN_ID)}static get iterableTemplateId(){return a.A.get(l.Yb.ITERABLE_TEMPLATE_ID)}static get preferredStore(){return a.A.get(l.Yb.PREFERRED_STORE)}static get anonymousId(){var e;return null===(e=window.rudderanalytics)||void 0===e?void 0:e.getAnonymousId()}static get currentDomain(){return(0,m.C4)()}static get sessionReplaySessionId(){return a.A.get(l.Yb.SESSION_REPLAY_SESSION_ID)}static set sessionReplaySessionId(e){a.A.set(l.Yb.SESSION_REPLAY_SESSION_ID,e)}static get getDefaultUserTraits(){var e,t;return{dynamic_yield_session_id:E.dynamicYieldClientID,dynamic_yield_server_id:E.dynamicYieldServerID,anonymousId:E.anonymousId,auth_state:E.userState,shopify_domain:window.location.host,allbirds_id:E.allbirdsId,user_id:E.userId,session_id:o.A.sessionId,session_replay_session_id:E.sessionReplaySessionId,screen_height:null===(e=window)||void 0===e||null===(e=e.screen)||void 0===e?void 0:e.height,screen_width:null===(t=window)||void 0===t||null===(t=t.screen)||void 0===t?void 0:t.width}}static getUserTraits(e){let{email:t,additionalTraits:r={}}=e,i={};if(t){const e=s().sha256().update(t).digest("hex");i={email:E.encryptedEmail||(0,I.g)(t),is_using_encrypted_email:!0,hashed_email:e}}return(0,n.omitBy)({...E.getDefaultUserTraits,...i,...r},n.isNil)}static shouldUpdateUser(e,t,r){if(!r)return!(0,n.isMatch)(e,t);const{email:i,...s}=e,{email:a,...l}=t;return!(0,n.isMatch)(s,l)}static setUserEmail(e){a.A.set(l.Yb.ALLBIRDS_EMAIL,e,{domain:E.currentDomain,expires:365.25})}static setUserEncryptedEmail(e){a.A.set(l.Yb.ALLBIRDS_ENCRYPTED_EMAIL,e,{domain:E.currentDomain,expires:365.25})}static setUserState(e){a.A.set(l.Yb.USER_STATE,e,{domain:E.currentDomain,expires:365.25})}static setUserAllbirdsId(e){return a.A.set(l.Yb.ALLBIRDS_ID,e,{domain:E.currentDomain,expires:365.25})}static setUserId(e){return a.A.set(l.Yb.USER_ID,e,{domain:E.currentDomain,expires:365})}static setPreferredStore(e){a.A.set(l.Yb.PREFERRED_STORE,e,{expires:365.25})}static tryGetAllbirdsIdFromUrl(){return(0,n.get)((0,m.JO)(),A.TN)}static trySetAllbirdsIdFromUrl(){const e=E.tryGetAllbirdsIdFromUrl();e&&E.setUserAllbirdsId(e)}static tryGetUserIdFromUrl(){return(0,n.get)((0,m.JO)(),A.tz)}static trySetUserIdFromUrl(){const e=E.tryGetUserIdFromUrl();e&&E.setUserId(e)}static setIterableCampaignId(e){return a.A.set(l.Yb.ITERABLE_CAMPAIGN_ID,e,{domain:E.currentDomain,expires:1})}static setIterableTemplateId(e){return a.A.set(l.Yb.ITERABLE_TEMPLATE_ID,e,{domain:E.currentDomain,expires:1})}static tryGetIterableCampaignIdFromUrl(){return(0,n.get)((0,m.JO)(),A.ey)}static tryGetIterableTemplateIdFromUrl(){return(0,n.get)((0,m.JO)(),A.qw)}static trySetIterableRevenueTrackingIdsFromUrl(){const e=E.tryGetIterableCampaignIdFromUrl(),t=E.tryGetIterableTemplateIdFromUrl();e&&t&&(E.setIterableCampaignId(e),E.setIterableTemplateId(t))}static clearUser(){a.A.remove(l.Yb.ALLBIRDS_EMAIL),a.A.remove(l.Yb.ALLBIRDS_ENCRYPTED_EMAIL),a.A.remove(l.Yb.ALLBIRDS_ID),a.A.remove(l.Yb.USER_ID),a.A.remove(l.Yb.ITERABLE_CAMPAIGN_ID),a.A.remove(l.Yb.ITERABLE_TEMPLATE_ID),E.setUserState(l.rZ.ANONYMOUS)}static identifyActionEmail(e,t){const r=E.userState,i=(0,I.g)(e);t===l.rZ.LOGGED_IN?(E.setUserState(l.rZ.LOGGED_IN),E.setUserEncryptedEmail(i)):r!==l.rZ.LOGGED_IN&&(E.setUserState(l.rZ.IDENTIFIED),E.setUserEncryptedEmail(i))}static identifyPageloadEmail(){const e=E.userState,t=E.encryptedEmail,r=a.A.get(A.J1),i=u.A.customerAccountEmail;let s;if(i){s=l.rZ.LOGGED_IN;const e=(0,I.g)(i);E.setUserEncryptedEmail(e)}else if(e===l.rZ.IDENTIFIED||t)s=l.rZ.IDENTIFIED;else if(r){s=l.rZ.IDENTIFIED;const e=(0,I.g)(r);E.setUserEncryptedEmail(e)}else s=l.rZ.ANONYMOUS;E.setUserState(s),E.trySetAllbirdsIdFromUrl(),E.trySetUserIdFromUrl(),E.trySetIterableRevenueTrackingIdsFromUrl(),c.A.pushEvent({event:"pageData",attributes:{userState:s}})}static setSmsMarketingOptIn(e){d.A.setSessionStorageItem(l.Rt.ALLBIRDS_SMS_MARKETING_OPT_IN,!!e)}static getSmsMarketingOptIn(){return!!d.A.getSessionStorageItem(l.Rt.ALLBIRDS_SMS_MARKETING_OPT_IN)}},_=E},34721:(e,t,r)=>{r.d(t,{nM:()=>E,i:()=>m,Ay:()=>f});var i=r(97857),s=r(2543),a=r(53229),n=r(16396);const l="DEFAULT",o="COLOR_SWATCHES",c="SIZE_BUTTONS",I="EQUALITY",d="INCLUDES",u="SIZE_AVAILABILITY",m={MATERIAL:"material",HUE:"hue",AVAILABILITY:"isAvailable",BEST_FOR:"bestFor",SIZE:"size"},A={[m.MATERIAL]:{filterIdentifier:m.MATERIAL,attributeField:"material",matchType:I,appearance:l},[m.HUE]:{filterIdentifier:m.HUE,attributeField:"hues",matchType:d,appearance:o},[m.AVAILABILITY]:{filterIdentifier:m.AVAILABILITY,attributeField:"isAvailable",matchType:I,appearance:l},[m.BEST_FOR]:{filterIdentifier:m.BEST_FOR,attributeField:"bestFor",matchType:d,appearance:l},[m.SIZE]:{filterIdentifier:m.SIZE,attributeField:"sizeHandles",matchType:u,appearance:c}},E=[m.SIZE,m.BEST_FOR,m.MATERIAL,m.HUE],_="shoe",p="unisexShoe",g="apparel",S="unisexApparel";var b;class y{}b=y,(0,i.A)(y,"_resolveCache",(e=>{let{cacheKey:t}=e;return t||(0,s.uniqueId)()})),(0,i.A)(y,"_executeFilter",(e=>{let{items:t,filterItem:r,cacheKey:i}=e;if(n.A.debug(`_executeFilter - uncached (${i})`),!r)throw new Error(`_executeFilter - missing filterItem (${JSON.stringify(r)})`);const{configuration:a,values:l}=r;if(!a)throw new Error(`_executeFilter - missing filterItem.configuration (${JSON.stringify(r)})`);return(0,s.filter)(t,(e=>{const t=(0,s.get)(e,a.attributeField),i=(0,s.some)(l,(i=>((e,t,i)=>{if(a.matchType===I)return e===t;if(a.matchType===d)return(0,s.includes)(e,t);if(a.matchType===u)return!!i.sizes[t]&&i.sizes[t].available;throw new Error(`_executeFilter - unknown filterItem.configuration.matchType (${JSON.stringify(r)})`)})(t,i,e)));return i}))})),(0,i.A)(y,"executeFilter",(0,s.memoize)(b._executeFilter,b._resolveCache)),(0,i.A)(y,"_executeFilters",(e=>{let{items:t,filterItems:r,cacheKey:i}=e;return n.A.debug(`_executeFilters - uncached (${i})`),(0,s.reduce)(r,((e,t)=>b.executeFilter({items:e,filterItem:t})),t)})),(0,i.A)(y,"executeFilters",(0,s.memoize)(b._executeFilters,b._resolveCache)),(0,i.A)(y,"_enumeratePossibleFilterOptions",(e=>{let{items:t,filterConfiguration:r,cacheKey:i}=e;n.A.debug(`_enumeratePossibleFilterOptions - uncached (${i})`);const l={};if(!r)throw new Error(`_enumeratePossibleFilterOptions - missing filterConfiguration (${JSON.stringify(r)})`);(0,s.forEach)(t,(e=>{const t=(0,s.get)(e,r.attributeField),i=null==e?void 0:e.type;t&&i!==a.QE.GIFT_CARDS&&(r.matchType===I&&(0,s.set)(l,t,{option:t}),r.matchType===d&&(0,s.forEach)(t,(e=>{(0,s.set)(l,e,{option:e})})),r.matchType===u&&(0,s.forEach)(t,(t=>{const r=!(0,s.isNaN)(parseFloat(t)),i=2===t.split("-").length;let a;a=3===t.split("-").length?S:i?p:r?_:g,(0,s.set)(l,t,{label:e.sizes[t].value,option:t,grouping:a})})))}));const o=b.mapPossibleFilterOptionsToArray(l);return[...b.sortPossibleFilterOptionsArray(o.filter((e=>(null==e?void 0:e.grouping)!==g)),r.matchType),...b.sortPossibleFilterOptionsArray(o.filter((e=>(null==e?void 0:e.grouping)==g)),r.matchType)]})),(0,i.A)(y,"enumeratePossibleFilterOptions",(0,s.memoize)(b._enumeratePossibleFilterOptions,b._resolveCache)),(0,i.A)(y,"getFilterConfiguration",(e=>{let{filterIdentifier:t}=e;return(0,s.get)(A,[t])})),(0,i.A)(y,"_determineRelevantFilterIdentifiers",(e=>{let{items:t,filterIdentifiers:r,cacheKey:i}=e;return n.A.debug(`_determineRelevantFilterIdentifiers - uncached (${i})`),(0,s.reduce)(r,((e,r)=>{const i=b.getFilterConfiguration({filterIdentifier:r}),a=b._enumeratePossibleFilterOptions({items:t,filterConfiguration:i});return(0,s.size)(a)>1&&e.push(r),e}),[])})),(0,i.A)(y,"determineRelevantFilterIdentifiers",(0,s.memoize)(b._determineRelevantFilterIdentifiers,b._resolveCache)),(0,i.A)(y,"_determineRelevantCollectionPageFilterIdentifiers",(e=>{let{items:t,cacheKey:r}=e;return n.A.debug(`_determineRelevantCollectionPageFilterIdentifiers - uncached (${r})`),b._determineRelevantFilterIdentifiers({items:t,filterIdentifiers:E})})),(0,i.A)(y,"determineRelevantCollectionPageFilterIdentifiers",(0,s.memoize)(b._determineRelevantCollectionPageFilterIdentifiers,b._resolveCache)),(0,i.A)(y,"mapPossibleFilterOptionsToArray",(e=>Object.values(e))),(0,i.A)(y,"sortPossibleFilterOptionsArray",(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if((arguments.length>1?arguments[1]:void 0)!==u)return e;const t=[],r=[],i=e=>{const t=(0,s.toNumber)(e.replace(/^-/,"").replace("-","."));return 0===t?NaN:t};return e.forEach((e=>{const a=i(e.option);(0,s.isNaN)(a)?t.push(e):r.push(e)})),r.sort(((e,t)=>i(e.option)-i(t.option))),[...r,...t]}));const f=y}}]);
//# sourceMappingURL=33.287290ecb2ca1a0f9576.chunk.js.map